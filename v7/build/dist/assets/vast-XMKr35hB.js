import{d as _,r,g as k,o as q,c as f,a as t,w as x,v as L,b as O,F as N,e as $,f as h,t as J,h as Q}from"./index-iyQ0fk6r.js";import{c as W}from"./sdk-CDpKy7gT.js";import{l as z}from"./loadScript-wOdhQs3s.js";import{_ as G}from"./export-helper-DlAUqK2U.js";import"./zoid-DaRsBbJ-.js";const K="https://cdn.jsdelivr.net/npm/hls.js@latest";let c=null;function P(){c=null}function X(){const p=window;return p.Hls?Promise.resolve(p.Hls):c||(c=z(K).then(()=>p.Hls),c.then(P).catch(P),c)}const Y={class:"container"},Z={class:"flex flex-col space-y-2"},ee={class:""},te={class:"w-30%"},ne={open:""},se="https://rs.sigmadrm.com/sdk/sigmaplayer/2.0.0/SigmaPlayer.min.js",oe=_({__name:"App",setup(p){const w=r([]);r([]);const a=r(k(window.location.href).url),i=r(k(window.location.href).adsUrl),S=r();function H(){return new Promise((n,e)=>{const s=indexedDB.open("TrackingLogDB",1);s.onerror=o=>e(`IndexedDB error: ${o.target.error}`),s.onsuccess=o=>n(o.target.result),s.onupgradeneeded=o=>{o.target.result.createObjectStore("trackingLog",{keyPath:"id",autoIncrement:!0})}})}function D(n){const s=S.value.transaction(["trackingLog"],"readwrite").objectStore("trackingLog"),o={...n,timestamp:new Date().toISOString(),beaconUrls:n.beaconUrls.join(",")};s.add(o)}const l=r();function R(n){return new Promise((e,s)=>{const o=document.createElement("script");o.async=!0,o.src=n,o.onload=e,o.onerror=s,document.body.appendChild(o)})}let d=null;function b(){d=null}function C(){return window.SigmaManager?Promise.resolve(window.SigmaManager):d||(d=R(se).then(()=>window.SigmaManager),d.then(b).catch(b),d)}function u(n,e){const s=document.querySelector("#video1"),o=document.querySelector("#adContainer1");W({video:s,adContainer:o,adsUrl:e}).then(({onEventTracking:I,sigmaPlayer:T,destroy:V})=>{const m=new Hls;T.attachHls(m),m.loadSource(n),m.attachMedia(s),m.on(Hls.Events.MANIFEST_PARSED,()=>{s.play()}),I("*",U=>{w.value.push(U),D({type:"video1",...U})}),l.value=()=>{V(),m.destroy()}})}const v=r(a),g=r(i),y=r({merchantId:"",appId:"",sessionId:"",userId:""});function B(){const n=new URL(window.location.href);n.searchParams.set("url",v.value),n.searchParams.set("adsUrl",g.value),Object.entries(y.value).forEach(([e,s])=>{n.searchParams.set(`drm_${e}`,s)}),window.location.href=n.toString()}q(async()=>{await C(),await X(),S.value=await H(),u(a.value,i.value);const n=new URLSearchParams(window.location.search);y.value={merchantId:n.get("drm_merchantId")||"",appId:n.get("drm_appId")||"",sessionId:n.get("drm_sessionId")||"",userId:n.get("drm_userId")||""}});function M(){l.value(),a.value="https://cdn-lrm-test.sigma.video/manifest/origin04/scte35-video-audio-clear/master.m3u8",u(a.value,i.value)}function j(){l.value(),a.value="https://cdn-lrm-test.sigma.video/manifest/origin04/scte35-av2s-clear/master.m3u8",u(a.value,i.value)}function A(){l.value(),a.value="https://cdn-lrm-test.sigma.video/manifest/origin04/scte35-av4s-clear/master.m3u8",u(a.value,i.value)}function E(){l.value(),a.value="https://cdn-lrm-test.sigma.video/manifest/origin04/scte35-av6s-clear/master.m3u8",u(a.value,i.value)}function F(){l.value(),a.value="https://cdn-lrm-test.sigma.video/manifest/origin04/av4s-clear/master.m3u8",u(a.value,i.value)}return(n,e)=>(h(),f("div",Y,[t("form",{class:"mb-4",onSubmit:O(B,["prevent"])},[t("div",Z,[e[7]||(e[7]=t("label",{for:"urlInput",class:"font-medium"},"URL:",-1)),x(t("input",{id:"urlInput","onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"text",class:"border rounded px-2 py-1"},null,512),[[L,v.value]]),e[8]||(e[8]=t("label",{for:"adsUrlInput",class:"font-medium"},"Ads URL:",-1)),x(t("input",{id:"adsUrlInput","onUpdate:modelValue":e[1]||(e[1]=s=>g.value=s),type:"text",class:"border rounded px-2 py-1"},null,512),[[L,g.value]]),e[9]||(e[9]=t("button",{type:"submit",class:"mt-4 rounded bg-blue-500 px-4 py-2 text-white transition-colors hover:bg-blue-600"}," Update and Reload ",-1))])],32),t("button",{onClick:e[2]||(e[2]=()=>M())}," Hls tách rời video và âm thanh "),t("button",{onClick:e[3]||(e[3]=()=>j())}," Hls ts 2s "),t("button",{onClick:e[4]||(e[4]=()=>A())}," HLS ts 4s "),t("button",{onClick:e[5]||(e[5]=()=>E())}," HLS ts 6s "),t("button",{onClick:e[6]||(e[6]=()=>F())}," HLS không quảng cáo "),t("div",ee,[e[11]||(e[11]=t("div",{class:"w-70%"},[t("div",{class:"aspect-ratio-video",style:{position:"relative",width:"1080px",overflow:"hidden"}},[t("video",{id:"video1",muted:"",controls:"",playsinline:"",preload:"auto",style:{position:"absolute",inset:"0",width:"100%",height:"100%"}}),t("div",{id:"adContainer1",style:{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",overflow:"hidden",width:"100%"}})])],-1)),t("div",te,[(h(!0),f(N,null,$(w.value,(s,o)=>(h(),f("div",{key:o,class:"event-log-item"},[t("details",ne,[e[10]||(e[10]=t("summary",null,"item",-1)),t("pre",null,J(JSON.stringify(s,null,2)),1)])]))),128))])])]))}}),ae=G(oe,[["__scopeId","data-v-2af33a89"]]);Q(ae).mount("#app");
