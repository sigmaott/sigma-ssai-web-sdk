import{d as R,r as m,g as x,o as j,c as w,a as t,w as l,v as u,u as r,i as U,b as A,F as B,e as F,f as v,t as E,h as H}from"./index-iyQ0fk6r.js";import{l as q}from"./loadScript-wOdhQs3s.js";import{_ as N}from"./export-helper-DlAUqK2U.js";const O="https://cdn.jsdelivr.net/npm/hls.js@latest";let p=null;function M(){p=null}function T(){const c=window;return c.Hls?Promise.resolve(c.Hls):p||(p=q(O).then(()=>c.Hls),p.then(M).catch(M),p)}const G={class:"container"},J={class:"flex flex-col space-y-2"},Q={class:"mt-4 flex flex-col space-y-2"},W={class:""},$={class:"w-30%"},z={open:""},K="https://sdrm-test.gviet.vn:9080/static/ssai/lib/web/SigmaManager_3.0.0.min.js",X=R({__name:"App",setup(c){const g=m([]),y=x(window.location.href).url,b=x(window.location.href).adsUrl,D=m();function P(n){return new Promise((e,s)=>{const d=document.createElement("script");d.async=!0,d.src=n,d.onload=e,d.onerror=s,document.body.appendChild(d)})}let i=null;function h(){i=null}function V(){return window.SigmaManager?Promise.resolve(window.SigmaManager):i||(i=P(K).then(()=>window.SigmaManager),i.then(h).catch(h),i)}const f=m(y),I=m(b),o=m({merchantId:"",appId:"",sessionId:"",userId:""});function k(){const n=new URL(window.location.href);n.searchParams.set("url",f.value),n.searchParams.set("adsUrl",I.value),Object.entries(o.value).forEach(([e,s])=>{n.searchParams.set(`drm_${e}`,s)}),window.location.href=n.toString()}function C(){const n=document.querySelector("#video1"),e=document.querySelector("#adContainer1");window.SigmaDaiSdk.createSigmaDai({video:n,adContainer:e,adsUrl:b}).then(async({onEventTracking:s,sigmaPlayer:d,destroy:L})=>{const a=window.sigmaManager||new window.SigmaManager;window.sigmaManager=a,a.config={enableWorker:!0},a.mediaElm=n,a.nativeClient={module:"sigma_drm.js",wasmBaseUrl:"https://dev-streaming.gviet.vn:8783/micro/cms/sdk-dai/dist/drm/"},a.appInfo={browser:"Google-Chrome",merchantId:o.value.merchantId,appId:o.value.appId,sessionId:o.value.sessionId,userId:o.value.userId},a.loadSource(y,{method:"sigma"}),a.on("hlsManifestParsed",async()=>{d.attachSigmaDrm(a),n.play()}),s("*",S=>{g.value.push(S),addLogToDB({type:"video1",...S})}),D.value=L})}return j(async()=>{await V(),await T(),C();const n=new URLSearchParams(window.location.search);o.value={merchantId:n.get("drm_merchantId")||"",appId:n.get("drm_appId")||"",sessionId:n.get("drm_sessionId")||"",userId:n.get("drm_userId")||""}}),(n,e)=>(v(),w("div",G,[t("form",{class:"mb-4",onSubmit:A(k,["prevent"])},[t("div",J,[e[11]||(e[11]=t("label",{for:"urlInput",class:"font-medium"},"URL:",-1)),l(t("input",{id:"urlInput","onUpdate:modelValue":e[0]||(e[0]=s=>U(f)?f.value=s:null),type:"text",class:"border rounded px-2 py-1"},null,512),[[u,r(f)]]),e[12]||(e[12]=t("label",{for:"adsUrlInput",class:"font-medium"},"Ads URL:",-1)),l(t("input",{id:"adsUrlInput","onUpdate:modelValue":e[1]||(e[1]=s=>U(I)?I.value=s:null),type:"text",class:"border rounded px-2 py-1"},null,512),[[u,r(I)]]),t("div",Q,[e[6]||(e[6]=t("h3",{class:"font-medium"}," DRM Settings: ",-1)),e[7]||(e[7]=t("label",{for:"merchantId",class:"font-medium"},"Merchant ID:",-1)),l(t("input",{id:"merchantId","onUpdate:modelValue":e[2]||(e[2]=s=>r(o).merchantId=s),type:"text",class:"border rounded px-2 py-1"},null,512),[[u,r(o).merchantId]]),e[8]||(e[8]=t("label",{for:"appId",class:"font-medium"},"App ID:",-1)),l(t("input",{id:"appId","onUpdate:modelValue":e[3]||(e[3]=s=>r(o).appId=s),type:"text",class:"border rounded px-2 py-1"},null,512),[[u,r(o).appId]]),e[9]||(e[9]=t("label",{for:"sessionId",class:"font-medium"},"Session ID:",-1)),l(t("input",{id:"sessionId","onUpdate:modelValue":e[4]||(e[4]=s=>r(o).sessionId=s),type:"text",class:"border rounded px-2 py-1"},null,512),[[u,r(o).sessionId]]),e[10]||(e[10]=t("label",{for:"userId",class:"font-medium"},"User ID:",-1)),l(t("input",{id:"userId","onUpdate:modelValue":e[5]||(e[5]=s=>r(o).userId=s),type:"text",class:"border rounded px-2 py-1"},null,512),[[u,r(o).userId]])]),e[13]||(e[13]=t("button",{type:"submit",class:"mt-4 rounded bg-blue-500 px-4 py-2 text-white transition-colors hover:bg-blue-600"}," Update and Reload ",-1))])],32),t("div",W,[e[15]||(e[15]=t("div",{class:"w-70%"},[t("div",{class:"aspect-ratio-video",style:{position:"relative",width:"720px",overflow:"hidden"}},[t("video",{id:"video1",muted:"",controls:"",playsinline:"",preload:"auto",style:{position:"absolute",inset:"0",width:"100%",height:"100%"}}),t("div",{id:"adContainer1",style:{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",overflow:"hidden",width:"100%"}})])],-1)),t("div",$,[(v(!0),w(B,null,F(r(g),(s,d)=>(v(),w("div",{key:d,class:"event-log-item"},[t("details",z,[e[14]||(e[14]=t("summary",null,"item",-1)),t("pre",null,E(JSON.stringify(s,null,2)),1)])]))),128))])])]))}}),Y=N(X,[["__scopeId","data-v-6890b464"]]);H(Y).mount("#app");
